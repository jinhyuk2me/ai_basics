## TL;DR
- 행렬 분해는 복잡한 행렬을 더 단순한 행렬의 곱으로 표현하여 연산을 효율화하고, 구조를 해석하게 해 준다.
- LU, QR, Cholesky, Eigendecomposition, SVD는 선형 시스템 해법, 최소제곱, 확률 모델링, 차원 축소 등 다양한 영역에 사용된다.
- 분해 가능 조건과 수치적 안정성을 이해해야 실제 구현에서 오류나 발산을 피할 수 있다.

## 핵심 개념
- **LU 분해 (A = LU)**
  - 하삼각행렬 L과 상삼각행렬 U의 곱. 가우스 소거법을 행렬 형태로 표현한 것.
  - 선형 시스템 `Ax = b`를 두 단계(`Ly = b`, `Ux = y`)로 해결 가능.
  - Pivoting(행 교환)이 필요한 경우 `PA = LU` 형태 사용.
- **QR 분해 (A = QR)**
  - 직교 행렬 Q와 상삼각 행렬 R로 분해, 직교성 덕분에 수치적으로 안정적.
  - 최소제곱 문제에서 정규방정식 `A^T A x = A^T b` 대신 `Rx = Q^T b`로 푸는 것이 오류에 더 강하다.
- **Cholesky 분해 (A = LL^T)**
  - 대칭 양의정부(SPD) 행렬에만 적용. 공분산 행렬, Hessian에서 자주 등장.
  - 가우시안 샘플링 시 `z ~ N(0, I)`를 `x = μ + Lz`로 변환해 `N(μ, Σ)` 샘플 생성.
- **Eigendecomposition**
  - 대각화 가능한 행렬에 대해 `A = PDP^{-1}`, 고유값 λ와 고유벡터 v.
  - 그래프 라플라시안의 고유값은 그래프 구조(연결성, 커뮤니티)를 알려준다.
- **SVD (A = U Σ V^T)**
  - 모든 실수 행렬에 적용 가능. 특이값 Σ는 비음수가 되며 행렬의 singular directions를 제공.
  - Rank-k 근사, 추천 시스템, 텍스트 임베딩(LSA) 등에 사용.
- **조건수(cond)**
  - `cond(A) = ||A|| * ||A^{-1}||`가 크면(특히 >> 1) 작은 오차가 큰 결과 오차로 이어진다.
  - 분해 과정에서 pivoting이나 regularization이 필요한 이유.

## PyTorch/NumPy 실습
```python
import torch

A = torch.tensor([[4., 2.],
                  [2., 3.]])

# LU
P, L, U = torch.linalg.lu(A)
print("PA ~ LU?", torch.allclose(P @ A, L @ U))

# QR
Q, R = torch.linalg.qr(A)
print("orthogonality", torch.allclose(Q.T @ Q, torch.eye(2)))

# Cholesky (SPD)
chol = torch.linalg.cholesky(A)
print("chol chol^T", chol @ chol.T)

# SVD
U, S, Vh = torch.linalg.svd(A)
print("singular values", S)
```
- `torch.linalg.lu`는 pivot 행렬 P까지 반환하므로 `P @ A = L @ U` 관계로 확인한다.
- QR의 직교성 확인, Cholesky가 존재하려면 A가 SPD여야 함을 직접 실험한다.
- SVD의 특이값은 행렬의 “에너지”가 축적된 정도를 보여준다.

## 실습 포인트
- 무작위 SPD 행렬을 생성 (`A = B B^T + εI`)하고 Cholesky 분해가 실패하지 않는지 확인.
- SVD를 이용해 이미지 압축: 상위 k개의 특이값만 남기고 복원해 PSNR/SSIM 비교.
- QR를 이용한 선형회귀: `torch.linalg.lstsq`와 결과가 동일한지 비교.
- 조건수가 큰 행렬을 만들어 정규방정식과 QR 방법의 수치적인 차이를 관찰.

## 추천 참고 자료
- Golub & Van Loan, *Matrix Computations*
- CMU 15-857 Numerical Linear Algebra 강의 노트
- Distill.pub, *Visualizing Matrix Factorizations*

## 다음 학습
- [[Math/선형대수 핵심 개요]]
- [[Operators/1. 선형 연산자]]
- [[Tensor 변환]]
- [[Math/Linear Algebra/7. 저랭크 근사와 행렬 분해]]
- [[Math/Numerical/1. 수치 선형대수]]
