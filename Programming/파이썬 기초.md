## TL;DR
- Python은 PyTorch를 포함한 딥러닝 생태계의 기본 언어이므로 문법, 함수형 패턴, 객체지향, NumPy 사용법을 탄탄히 해야 한다.
- 컨텍스트 매니저, 예외 처리, 타입 힌트, dataclass 등을 활용하면 유지보수성과 읽기 쉬운 코드를 만들 수 있다.
- NumPy 벡터화 사고를 익히면 PyTorch 텐서 조작과 데이터 파이프라인 작성이 훨씬 수월해진다.

## 핵심 개념
- **기본 자료형과 컬렉션**
  - 숫자형, 문자열, 불리언, 리스트, 튜플, 딕셔너리, 집합.
  - 리스트 컴프리헨션 `[x**2 for x in range(5) if x % 2 == 0]`, 슬라이싱 `arr[start:stop:step]`.
- **함수와 스코프**
  - 기본 인자/키워드 인자, 가변 인자 `*args`, `**kwargs`.
  - 클로저와 데코레이터(@decorator)로 함수 기능 확장, 로깅·시간 측정 등에 활용.
- **객체지향 패턴**
  - 클래스 정의, `__init__`, `__repr__`, `__call__`, `__len__` 등 매직 메서드.
  - 상속과 믹스인 구조, PyTorch `nn.Module` 이해에 도움이 된다.
- **예외 처리와 컨텍스트 매니저**
  - `try/except/else/finally`, `raise`로 명확한 오류 전달.
  - `with open(...) as f:` 패턴과 커스텀 컨텍스트 매니저(`__enter__`, `__exit__`).
- **가상환경과 패키지**
  - `python -m venv`, `conda`, `poetry`로 독립적인 개발 환경 구축.
  - `requirements.txt`, `pyproject.toml`, `pip install -e .` 등 패키지 관리 기본.
- **NumPy 기본**
  - 배열 생성(`np.array`, `np.zeros`, `np.linspace`), reshape, 브로드캐스팅 규칙.
  - 벡터화 연산, ufunc(`np.exp`, `np.sin`), 난수(`np.random.default_rng`).

## 예제 코드
```python
from dataclasses import dataclass
from typing import Iterable, Iterator, List

@dataclass
class Batch:
    data: List[float]
    label: int

def batch_loader(values: Iterable[float], batch_size: int) -> Iterator[Batch]:
    batch, label = [], 0
    for v in values:
        batch.append(v)
        if len(batch) == batch_size:
            yield Batch(data=batch.copy(), label=label)
            batch.clear()
            label += 1

for batch in batch_loader(range(10), batch_size=3):
    print(batch)
```
- dataclass는 단순 데이터 구조를 깔끔하게 표현해 주며, generator는 메모리 효율적인 데이터 스트리밍을 가능하게 한다.

### NumPy 벡터화 비교
```python
import numpy as np
import time

arr = np.random.rand(1_000_000)

start = time.time()
result_loop = [x ** 2 for x in arr]
loop_time = time.time() - start

start = time.time()
result_vec = arr ** 2
vec_time = time.time() - start

print(f"loop: {loop_time:.3f}s, vectorized: {vec_time:.3f}s")
```
- 벡터화는 순수 Python 루프보다 훨씬 빠르며, PyTorch 텐서 연산에서도 동일한 장점을 제공한다.

## 실습 포인트
- CSV 파일을 읽어 특정 열을 전처리하고 리스트 컴프리헨션과 dict comprehension으로 결과 정리.
- 예외 처리로 오류를 잡아내고, 사용자 정의 예외 클래스로 명확한 에러 메시지 만들기.
- `poetry`로 새 프로젝트를 초기화하고, `pyproject.toml`에 의존성을 기록한 뒤 `poetry run`으로 스크립트 실행.
- IPython/Jupyter에서 `%timeit`으로 루프 vs 벡터화 성능 비교.

## 추천 참고 자료
- *Fluent Python* (Luciano Ramalho)
- Real Python 튜토리얼: https://realpython.com/
- NumPy Quickstart: https://numpy.org/doc/stable/user/quickstart.html

## 다음 학습
- [[Programming/자료구조와 알고리즘]]
- [[Tensor 생성]]
- [[Project Tooling]]
